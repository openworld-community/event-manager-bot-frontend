var W=Object.defineProperty;var X=(t,e,n)=>e in t?W(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var m=(t,e,n)=>(X(t,typeof e!="symbol"?e+"":e,n),n);import{S as Y,i as Z,s as ee,y as q,a as C,k as y,q as R,z as L,c as O,l as x,m as b,r as j,h as p,n as w,A as P,b as A,N as _,F as te,g,f as re,d as E,B as z,T as ne,O as ae,v as ie}from"../chunks/index.e625c2ba.js";import{u as J,p as se,y as le,x as oe}from"../chunks/effector.ac325974.js";import{b as c,I as me}from"../chunks/enums.44064bc9.js";import{T as ce}from"../chunks/TelegramScript.a6cd781d.js";const G=[{label:"Name",systemName:"name",initValue:"",type:"text",variant:c.formEvent},{label:"Link",systemName:"link",initValue:"",type:"text",variant:c.formEvent},{label:"Start date",systemName:"start",initValue:"",type:"date",variant:c.formEvent},{label:"Remind date",systemName:"remind",initValue:"",type:"date",variant:c.formEvent},{label:"Max adults amount",systemName:"max_adults",initValue:"100",type:"number",variant:c.formEvent},{label:"Max children amount",systemName:"max_children",initValue:"100",type:"number",variant:c.formEvent},{label:"Max adults per reservation",systemName:"max_adults_per_reservation",initValue:"4",type:"number",variant:c.formEvent},{label:"Max children per reservation",systemName:"max_children_per_reservation",initValue:"4",type:"number",variant:c.formEvent},{label:"Adult ticket price",systemName:"adult_ticket_price",initValue:"100",type:"number",variant:c.formEvent},{label:"Children ticket price",systemName:"children_ticket_price",initValue:"50",type:"number",variant:c.formEvent},{label:"Currency",systemName:"currency",initValue:"USD",type:"text",variant:c.formEvent}],_e="https://test.eventmanagerbot.peredelano.io:8443",ue=`${_e}/event`;class he{constructor(e){m(this,"adult_ticket_price");m(this,"children_ticket_price");m(this,"currency");m(this,"link");m(this,"max_adults");m(this,"max_adults_per_reservation");m(this,"max_children");m(this,"max_children_per_reservation");m(this,"name");m(this,"remind");m(this,"ts");this.adult_ticket_price=e.adult_ticket_price,this.children_ticket_price=e.children_ticket_price,this.currency=e.currency,this.link=e.link,this.max_adults=e.max_adults,this.max_adults_per_reservation=e.max_adults_per_reservation,this.max_children=e.max_children,this.max_children_per_reservation=e.max_children_per_reservation,this.name=e.name,this.remind=e.remind,this.ts=new Date(e.start)}toObject(){return{id:Math.floor(Math.random()*1e3),adult_ticket_price:+this.adult_ticket_price,children_ticket_price:+this.children_ticket_price,currency:this.currency,link:this.link,max_adults:+this.max_adults,max_adults_per_reservation:+this.max_adults_per_reservation,max_children:+this.max_children,max_children_per_reservation:+this.max_children_per_reservation,name:this.name,remind:+this.remind,ts:+this.ts}}}const pe=(t,e)=>e,de=t=>e=>t(e.target.value),fe=t=>e=>t(e.currentTarget),F=G.map(t=>{const e=J(),n=se(t.initValue).on(e,pe);return{...t,handler:de(e),valueStore:n}}),K=J(),ve=le(async t=>{const e=new he(t),n=fetch(ue,{method:"POST",mode:"cors",headers:{"сontent-type":"application/json"},body:JSON.stringify(e.toObject())});return n.then(s=>console.log(s)),await n}),ye=t=>{const e={};for(let n=0;n<t.length;n++)e[G[n].systemName]=t[n];return e};oe({source:F.map(({valueStore:t})=>t),clock:K,fn:ye,target:ve});function B(t,e,n){const s=t.slice();return s[0]=e[n],s}function U(t){let e,n;return e=new me({props:{label:t[0].label,type:t[0].type,handler:t[0].handler,valueStore:t[0].valueStore,variant:t[0].variant}}),{c(){q(e.$$.fragment)},l(s){L(e.$$.fragment,s)},m(s,o){P(e,s,o),n=!0},p:ae,i(s){n||(g(e.$$.fragment,s),n=!0)},o(s){E(e.$$.fragment,s),n=!1},d(s){z(e,s)}}}function xe(t){let e,n,s,o,f,N,$,u,V,d,S,k,T,I;e=new ce({});let h=F,i=[];for(let r=0;r<h.length;r+=1)i[r]=U(B(t,h,r));const Q=r=>E(i[r],1,1,()=>{i[r]=null});return{c(){q(e.$$.fragment),n=C(),s=y("main"),o=y("form"),f=y("h1"),N=R("Create new event"),$=C(),u=y("div");for(let r=0;r<i.length;r+=1)i[r].c();V=C(),d=y("button"),S=R("Create event"),this.h()},l(r){L(e.$$.fragment,r),n=O(r),s=x(r,"MAIN",{});var l=b(s);o=x(l,"FORM",{class:!0});var a=b(o);f=x(a,"H1",{});var v=b(f);N=j(v,"Create new event"),v.forEach(p),$=O(a),u=x(a,"DIV",{class:!0});var D=b(u);for(let M=0;M<i.length;M+=1)i[M].l(D);D.forEach(p),V=O(a),d=x(a,"BUTTON",{type:!0});var H=b(d);S=j(H,"Create event"),H.forEach(p),a.forEach(p),l.forEach(p),this.h()},h(){w(u,"class","form--box svelte-uo70fe"),w(d,"type","submit"),w(o,"class","form svelte-uo70fe")},m(r,l){P(e,r,l),A(r,n,l),A(r,s,l),_(s,o),_(o,f),_(f,N),_(o,$),_(o,u);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(u,null);_(o,V),_(o,d),_(d,S),k=!0,T||(I=te(o,"submit",fe(K)),T=!0)},p(r,[l]){if(l&0){h=F;let a;for(a=0;a<h.length;a+=1){const v=B(r,h,a);i[a]?(i[a].p(v,l),g(i[a],1)):(i[a]=U(v),i[a].c(),g(i[a],1),i[a].m(u,null))}for(ie(),a=h.length;a<i.length;a+=1)Q(a);re()}},i(r){if(!k){g(e.$$.fragment,r);for(let l=0;l<h.length;l+=1)g(i[l]);k=!0}},o(r){E(e.$$.fragment,r),i=i.filter(Boolean);for(let l=0;l<i.length;l+=1)E(i[l]);k=!1},d(r){z(e,r),r&&p(n),r&&p(s),ne(i,r),T=!1,I()}}}class $e extends Y{constructor(e){super(),Z(this,e,null,xe,ee,{})}}export{$e as component};
