import{S as We,i as He,s as Ue,k as W,q as Re,a as ve,l as H,m as J,r as je,h as I,c as _e,n as he,b as Ve,G as E,J as ut,K as Et,u as It,H as K,L as zt,M as qt,N as Ft,o as Rt,y as ft,z as ct,A as dt,g as ce,f as jt,d as ke,B as mt,O as Vt,v as Dt}from"../chunks/index.4ff09b3d.js";function Je(e,t){for(let r in e)t(e[r],r)}function A(e,t){e.forEach(t)}function $(e,t){if(!e)throw Error(t)}function Z({node:e=[],from:t,source:r,parent:a=t||r,to:n,target:i,child:l=n||i,scope:f={},meta:m={},family:c={type:"regular"},regional:d}={}){let g=de(a),b=de(c.links),o=de(c.owners),u=[];A(e,h=>h&&R(u,h));let s={id:Kt(),seq:u,next:de(l),meta:m,scope:f,family:{type:c.type||"crosslink",links:b,owners:o}};return A(b,h=>R(Ae(h),s)),A(o,h=>R(Ce(h),s)),A(g,h=>R(h.next,s)),d&&te&&Ee(me(te),[s]),s}function ge(e,t,r){let a,n=V,i=null,l=w;if(e.target&&(t=e.params,r=e.defer,a=e.meta,n="page"in e?e.page:n,e.stack&&(i=e.stack),l=G(e)||l,e=e.target),l&&w&&l!==w&&(w=null),Array.isArray(e))for(let u=0;u<e.length;u++)U("pure",n,F(e[u]),i,t[u],l,a);else U("pure",n,F(e),i,t,l,a);if(r&&!be)return;let f,m,c,d,g,b,o={isRoot:be,currentPage:V,scope:w,isWatch:xe,isPure:we};be=0;e:for(;d=tr();){let{idx:u,stack:s,type:h}=d;c=s.node,V=g=s.page,w=G(s),g?b=g.reg:w&&(b=w.reg);let p=!!g,v=!!w,y={fail:0,scope:c.scope};f=m=0;for(let _=u;_<c.seq.length&&!f;_++){let k=c.seq[_];if(k.order){let{priority:x,barrierID:S}=k.order,N=S?g?`${g.fullID}_${S}`:S:0;if(_!==u||h!==x){S?ze.has(N)||(ze.add(N),Pe(_,s,x,S)):Pe(_,s,x);continue e}S&&ze.delete(N)}switch(k.type){case"mov":{let S,N=k.data;switch(N.from){case Q:S=me(s);break;case"a":case"b":S=s[N.from];break;case"value":S=N.store;break;case"store":if(b&&!b[N.store.id])if(p){let Ie=St(g,N.store.id);s.page=g=Ie,Ie?b=Ie.reg:v?(se(w,N.store,0,1,N.softRead),b=w.reg):b=void 0}else v&&se(w,N.store,0,1,N.softRead);S=pe(b&&b[N.store.id]||N.store)}switch(N.to){case Q:s.value=S;break;case"a":case"b":s[N.to]=S;break;case"store":ar(g,w,c,N.target).current=S}break}case"compute":let x=k.data;if(x.fn){xe=M(c,"op")==="watch",we=x.pure;let S=x.safe?(0,x.fn)(me(s),y.scope,s):lr(y,x.fn,s);x.filter?m=!S:s.value=S,xe=o.isWatch,we=o.isPure}}f=y.fail||m}if(!f){let _=me(s),k=G(s);if(A(c.next,x=>{U("child",g,x,s,_,k)}),k){M(c,"needFxCounter")&&U("child",g,k.fxCount,s,_,k),M(c,"storeChange")&&U("child",g,k.storeChange,s,_,k),M(c,"warnSerialize")&&U("child",g,k.warnSerializeNode,s,_,k);let x=k.additionalLinks[c.id];x&&A(x,S=>{U("child",g,S,s,_,k)})}}}be=o.isRoot,V=o.currentPage,w=G(o)}function pt(e,t="combine"){let r=t+"(",a="",n=0;return Je(e,i=>{n<25&&(i!=null&&(r+=a,r+=ae(i)?ht(i).fullName:i.toString()),n+=1,a=", ")}),r+")"}function Ot(e,t){let r,a,n=e;if(t){let i=ht(t);e.length===0?(r=i.path,a=i.fullName):(r=i.path.concat([e]),a=i.fullName.length===0?e:i.fullName+"/"+e)}else r=e.length===0?[]:[e],a=e;return{shortName:n,fullName:a,path:r}}function Ge(e,t){let r=t?e:e[0];vt(r);let a=r.or,n=r.and;if(n){let i=t?n:n[0];if(P(i)&&"and"in i){let l=Ge(n,t);e=l[0],a={...a,...l[1]}}else e=n}return[e,a]}function q(e,...t){let r=Ke();if(r){let a=r.handlers[e];if(a)return a(r,...t)}}function O(e,t){let r=oe({or:t,and:typeof e=="string"?{name:e}:e}),a=(l,...f)=>(ne(!M(a,"derived"),"call of derived event","createEvent"),ne(!we,"unit call from pure function","operators like sample"),V?((m,c,d,g)=>{let b=V,o=null;if(c)for(o=V;o&&o.template!==c;)o=X(o);at(o);let u=m.create(d,g);return at(b),u})(a,n,l,f):a.create(l,f)),n=Ke(),i=Object.assign(a,{graphite:Z({meta:Nt(r.actualOp||"event",a,r),regional:1}),create:l=>(ge({target:a,params:l,scope:w}),l),watch:l=>wt(a,l),map:l=>qe(a,re,l,[B()]),filter:l=>qe(a,"filter",l.fn?l:l.fn,[B(Qe,1)]),filterMap:l=>qe(a,"filterMap",l,[B(),L(f=>!z(f),1)]),prepend(l){let f=O("* → "+a.shortName,{parent:X(a)});return q("eventPrepend",F(f)),ue(f,a,[B()],"prepend",l),sr(a,f),f}});return r!=null&&r.domain&&r.domain.hooks.event(i),T(i,"id",i.graphite.id),bt(i.graphite),i}function et(e,t,r,a){return Me(r,t,"first argument"),$(C(a),"second argument should be a function"),ne(!M(e,"derived"),`${t} in derived store`,`${t} in store created via createStore`),A(Array.isArray(r)?r:[r],n=>{e.off(n),Ne(e).set(n,xt(Mt(n,e,"on",Zt,a)))}),e}function ye(e,t){let r=oe(t),a=ie(e),n=O({named:"updates",derived:1});q("storeBase",a);let i=a.id,l={subscribers:new Map,updates:n,defaultState:e,stateRef:a,getState(){let o,u=a;if(V){let s=V;for(;s&&!s.reg[i];)s=X(s);s&&(o=s)}return!o&&w&&(se(w,a,1),o=w),o&&(u=o.reg[i]),pe(u)},setState:o=>ge({target:l,params:o,defer:1,scope:w}),reset:(...o)=>(A(o,u=>et(l,".reset",u,()=>l.defaultState)),l),on:(o,u)=>et(l,".on",o,u),off(o){let u=Ne(l).get(o);return u&&(u(),Ne(l).delete(o)),l},map(o,u){let s,h;P(o)&&(s=o,o=o.fn),ne(z(u),"second argument of store.map","updateFilter");let p=l.getState();Ke()?h=null:z(p)||(h=o(p,u));let v=ye(h,{name:`${l.shortName} → *`,derived:1,and:s}),y=Mt(l,v,re,De,o);return Oe(D(v),{type:re,fn:o,from:a}),D(v).noInit=1,q("storeMap",a,y),v},watch(o,u){if(!u||!ae(o)){let s=wt(l,o);return q("storeWatch",a,o)||o(l.getState()),s}return $(C(u),"second argument should be a function"),o.watch(s=>u(l.getState(),s))}},f=Nt("store",l,r),m=l.defaultConfig.updateFilter;l.graphite=Z({scope:{state:a,fn:m},node:[L((o,u,s)=>(s.scope&&!s.scope.reg[a.id]&&(s.b=1),o)),le(a),L((o,u,{a:s,b:h})=>!z(o)&&(o!==s||h),1),m&&B(De,1),j({from:Q,target:a})],child:n,meta:{...f,defaultState:e},regional:1}),T(l,"id",l.graphite.id),T(l,"rootStateRefId",i);let c=M(l,"serialize"),d=M(l,"derived"),g=c==="ignore",b=M(l,"sid");return b&&(T(l,"storeChange",1),a.sid=b),b||g||d||T(l,"warnSerialize",1),$(d||!z(e),"current state can't be undefined, use null instead"),Ee(l,[n]),r!=null&&r.domain&&r.domain.hooks.store(l),d||(l.reinit=O({named:"reinit"}),l.reset(l.reinit)),a.meta=l.graphite.meta,bt(l.graphite),l}function Pt(...e){let t,r,a;[e,a]=Ge(e);let n,i,l,f=e[e.length-1];if(C(f)?(r=e.slice(0,-1),t=f):r=e,r.length===1){let m=r[0];Y(m)||(n=m,i=1)}if(!i&&(n=r,t)){l=1;let m=t;t=c=>m(...c)}return $(P(n),"shape should be an object"),or(Array.isArray(n),!l,n,a,t)}function Tt(){let e={};return e.req=new Promise((t,r)=>{e.rs=t,e.rj=r}),e.req.catch(()=>{}),e}function Bt(e,t={}){let r=oe(C(e)?{handler:e}:e,t),a=O(C(e)?{handler:e}:e,{...t,actualOp:"effect"}),n=F(a);T(n,"op",a.kind="effect"),a.use=o=>($(C(o),".use argument should be a function"),d.scope.handler=o,a),a.use.getCurrent=()=>d.scope.handler;let i=a.finally=O({named:"finally",derived:1}),l=a.done=i.filterMap({named:"done",fn({status:o,params:u,result:s}){if(o==="done")return{params:u,result:s}}}),f=a.fail=i.filterMap({named:"fail",fn({status:o,params:u,error:s}){if(o==="fail")return{params:u,error:s}}}),m=a.doneData=l.map({named:"doneData",fn:({result:o})=>o}),c=a.failData=f.map({named:"failData",fn:({error:o})=>o}),d=Z({scope:{handler:a.defaultConfig.handler||(()=>$(0,`no handler used in ${a.getType()}`))},node:[L((o,u,s)=>{let h=u.handler,p=G(s);if(p){let v=p.handlers.unitMap.get(a)||p.handlers.sidMap[a.sid];v&&(h=v)}return o.handler=h,o},0,1),L(({params:o,req:u,handler:s,args:h=[o]},p,v)=>{let y=fr(v),_=lt(o,u,1,i,v,y),k=lt(o,u,0,i,v,y),[x,S]=ur(s,k,h);x&&(P(S)&&C(S.then)?S.then(_,k):_(S))},0,1)],meta:{op:"fx",fx:"runner"}});n.scope.runner=d,R(n.seq,L((o,{runner:u},s)=>{let h=X(s)?{params:o,req:{rs(p){},rj(p){}}}:o;return s.meta||(s.meta={fxID:Qt()}),ge({target:u,params:h,defer:1,scope:G(s),meta:s.meta}),h.params},0,1)),a.create=o=>{let u=Tt(),s={params:o,req:u};if(w&&!xe){let h=w;u.req.finally(()=>{rr(h)}).catch(()=>{})}return ge({target:a,params:s,scope:w}),u.req};let g=a.inFlight=ye(0,{serialize:"ignore",named:(M(a,"name")||a.graphite.id)+".inFlight"}).on(a,o=>o+1).on(i,o=>o-1).map({fn:o=>o,named:"inFlight"});T(i,"needFxCounter","dec"),T(a,"needFxCounter",1);let b=a.pending=g.map({fn:o=>o>0,named:"pending"});return Ee(a,[i,l,f,m,c,b,g]),r!=null&&r.domain&&r.domain.hooks.effect(a),a}function Lt(e,t){Me(e,"merge","first argument");let r=O({name:pt(e,"merge"),derived:1,and:t});return ue(e,r,[],"merge"),r}function Wt(e,t){let r=0;return A(dr,a=>{a in e&&($(e[a]!=null,At(t,a)),r=1)}),r}function Ht(...e){let t,r,a,n,[[i,l,f],m]=Ge(e),c=1;return z(l)&&P(i)&&Wt(i,"sample")&&(l=i.clock,f=i.fn,c=!i.greedy,n=i.filter,t=i.target,r=i.name,a=i.sid,i=i.source),mr("sample",l,i,n,t,f,r,m,c,1,0,a)}let Ut=typeof Symbol<"u"&&Symbol.observable||"@@observable",re="map",Q="stack",F=e=>e.graphite||e,Ae=e=>e.family.owners,Ce=e=>e.family.links,D=e=>e.stateRef,me=e=>e.value,Ne=e=>e.subscribers,X=e=>e.parent,G=e=>e.scope,M=(e,t)=>F(e).meta[t],T=(e,t,r)=>F(e).meta[t]=r,ht=e=>e.compositeName,ae=e=>(C(e)||P(e))&&"kind"in e;const gt=e=>t=>ae(t)&&t.kind===e;let Y=gt("store"),Jt=gt("domain"),Se=(e,t)=>{let r=e.indexOf(t);r!==-1&&e.splice(r,1)},R=(e,t)=>e.push(t),ne=(e,t,r)=>!e&&console.error(`${t} is deprecated${r?`, use ${r} instead`:""}`);const $e=()=>{let e=0;return()=>""+ ++e};let Gt=$e(),yt=$e(),Kt=$e(),Qt=$e(),te=null,bt=e=>{},Ke=()=>te,Xt=e=>(e&&te&&te.sidRoot&&(e=`${te.sidRoot}|${e}`),e),Ee=(e,t)=>{let r=F(e);A(t,a=>{let n=F(a);r.family.type!=="domain"&&(n.family.type="crosslink"),R(Ae(n),r),R(Ce(r),n)})},de=(e=[])=>(Array.isArray(e)?e:[e]).flat().map(F),P=e=>typeof e=="object"&&e!==null,C=e=>typeof e=="function",z=e=>e===void 0,vt=e=>$(P(e)||C(e),"expect first argument be an object");const tt=(e,t,r,a)=>$(!(!P(e)&&!C(e)||!("family"in e)&&!("graphite"in e)),`${t}: expect ${r} to be a unit (store, event or effect)${a}`);let Me=(e,t,r)=>{Array.isArray(e)?A(e,(a,n)=>tt(a,t,`${n} item of ${r}`,"")):tt(e,t,r," or array of units")},Yt=(e,t,r="target")=>A(de(t),a=>ne(!M(a,"derived"),`${e}: derived unit in "${r}"`,"createEvent/createStore")),De=(e,{fn:t},{a:r})=>t(e,r),Zt=(e,{fn:t},{a:r})=>t(r,e),Qe=(e,{fn:t})=>t(e);const _t=(e,t,r,a)=>{let n={id:yt(),type:e,data:t};return r&&(n.order={priority:r},a&&(n.order.barrierID=++er)),n};let er=0,j=({from:e="store",store:t,target:r,to:a=r?"store":Q,batch:n,priority:i})=>_t("mov",{from:e,store:t,to:a,target:r},i,n),Xe=({fn:e,batch:t,priority:r,safe:a=0,filter:n=0,pure:i=0})=>_t("compute",{fn:e,safe:a,filter:n,pure:i},r,t),kt=({fn:e})=>Xe({fn:e,priority:"effect"}),L=(e,t,r)=>Xe({fn:e,safe:1,filter:t,priority:r&&"effect"}),le=(e,t,r)=>j({store:e,to:t?Q:"a",priority:r&&"sampler",batch:1}),B=(e=Qe,t)=>Xe({fn:e,pure:1,filter:t}),ie=e=>({id:yt(),current:e}),pe=({current:e})=>e,Oe=(e,t)=>{e.before||(e.before=[]),R(e.before,t)},ee=null;const Ye=(e,t)=>{if(!e)return t;if(!t)return e;let r;return(e.v.type===t.v.type&&e.v.id>t.v.id||Te(e.v.type)>Te(t.v.type))&&(r=e,e=t,t=r),r=Ye(e.r,t),e.r=e.l,e.l=r,e},Ze=[];let rt=0;for(;rt<6;)R(Ze,{first:null,last:null,size:0}),rt+=1;const tr=()=>{for(let e=0;e<6;e++){let t=Ze[e];if(t.size>0){if(e===3||e===4){t.size-=1;let a=ee.v;return ee=Ye(ee.l,ee.r),a}t.size===1&&(t.last=null);let r=t.first;return t.first=r.r,t.size-=1,r.v}}},U=(e,t,r,a,n,i,l)=>Pe(0,{a:null,b:null,node:r,parent:a,value:n,page:t,scope:i,meta:l},e),Pe=(e,t,r,a=0)=>{let n=Te(r),i=Ze[n],l={v:{idx:e,stack:t,type:r,id:a},l:null,r:null};n===3||n===4?ee=Ye(ee,l):(i.size===0?i.first=l:i.last.r=l,i.last=l),i.size+=1},Te=e=>{switch(e){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},ze=new Set;let w,be=1,xe=0,we=0,V=null,rr=e=>{w=e},at=e=>{V=e};const St=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=X(e);if(e)return e}return null};let ar=(e,t,r,a,n)=>{let i=St(e,a.id);return i?i.reg[a.id]:t?(se(t,a,n),t.reg[a.id]):a};const nr=e=>e;let se=(e,t,r,a,n)=>{var i;let l=e.reg,f=t.sid,m=t==null||(i=t.meta)===null||i===void 0?void 0:i.serialize,c=e.fromSerialize&&m!=="ignore"&&(m==null?void 0:m.read)||nr;if(l[t.id])return;let d={id:t.id,current:t.current,meta:t.meta};if(d.id in e.values.idMap)d.current=e.values.idMap[d.id];else if(f&&f in e.values.sidMap&&!(f in e.sidIdMap))d.current=c(e.values.sidMap[f]);else if(t.before&&!n){let g=0,b=r||!t.noInit||a;A(t.before,o=>{switch(o.type){case re:{let u=o.from;if(u||o.fn){u&&se(e,u,r,a);let s=u&&l[u.id].current;b&&(d.current=o.fn?o.fn(s):s)}break}case"field":g||(g=1,d.current=Array.isArray(d.current)?[...d.current]:{...d.current}),se(e,o.from,r,a),b&&(d.current[o.field]=l[l[o.from.id].id].current)}})}f&&(e.sidIdMap[f]=t.id),l[t.id]=d};const lr=(e,t,r)=>{try{return t(me(r),e.scope,r)}catch(a){console.error(a),e.fail=1,e.failReason=a}};let oe=(e,t={})=>(P(e)&&(oe(e.or,t),Je(e,(r,a)=>{z(r)||a==="or"||a==="and"||(t[a]=r)}),oe(e.and,t)),t);const nt=(e,t)=>{Se(e.next,t),Se(Ae(e),t),Se(Ce(e),t)},Be=(e,t,r)=>{let a;e.next.length=0,e.seq.length=0,e.scope=null;let n=Ce(e);for(;a=n.pop();)nt(a,e),(t||r&&M(e,"op")!=="sample"||a.family.type==="crosslink")&&Be(a,t,M(a,"op")!=="on"&&r);for(n=Ae(e);a=n.pop();)nt(a,e),r&&a.family.type==="crosslink"&&Be(a,t,M(a,"op")!=="on"&&r)},fe=e=>e.clear();let ir=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),Y(e))fe(Ne(e));else if(Jt(e)){r=1;let a=e.history;fe(a.events),fe(a.effects),fe(a.stores),fe(a.domains)}Be(F(e),!!t,r)},xt=e=>{let t=()=>ir(e);return t.unsubscribe=t,t},ue=(e,t,r,a,n)=>Z({node:r,parent:e,child:t,scope:{fn:n},meta:{op:a},family:{owners:[e,t],links:t},regional:1}),wt=(e,t)=>($(C(t),".watch argument should be a function"),xt(Z({scope:{fn:t},node:[kt({fn:Qe})],parent:e,meta:{op:"watch"},family:{owners:e},regional:1}))),sr=(e,t,r="event")=>{X(e)&&X(e).hooks[r](t)},Nt=(e,t,r)=>{let a=oe(r),n=e==="domain",i=Gt(),{sid:l=null,named:f=null,domain:m=null,parent:c=m}=a,d=f||a.name||(n?"":i),g=Ot(d,c),b={op:t.kind=e,name:t.shortName=d,sid:t.sid=Xt(l),named:f,unitId:t.id=i,serialize:a.serialize,derived:a.derived,config:a};return t.parent=c,t.compositeName=g,t.defaultConfig=a,t.thru=o=>(ne(0,"thru","js pipe"),o(t)),t.getType=()=>g.fullName,!n&&(t.subscribe=o=>(vt(o),t.watch(C(o)?o:u=>o.next&&o.next(u))),t[Ut]=()=>t),b};const qe=(e,t,r,a)=>{let n;P(r)&&(n=r,r=r.fn);let i=O({name:`${e.shortName} → *`,derived:1,and:n});return ue(e,i,a,t,r),i},Mt=(e,t,r,a,n)=>{let i=D(t),l=j({store:i,to:"a",priority:"read"});r===re&&(l.data.softRead=1);let f=[l,B(a)];return q("storeOnMap",i,f,Y(e)&&D(e)),ue(e,t,f,r,n)},or=(e,t,r,a,n)=>{let i=e?u=>[...u]:u=>({...u}),l=e?[]:{},f=i(l),m=ie(f),c=ie(1);m.type=e?"list":"shape",m.noInit=1,q("combineBase",m,c);let d=ye(f,{name:pt(r),derived:1,and:a}),g=D(d);g.noInit=1,T(d,"isCombine",1);let b=le(m);b.order={priority:"barrier"};let o=[L((u,s,h)=>(h.scope&&!h.scope.reg[m.id]&&(h.c=1),u)),b,j({store:c,to:"b"}),L((u,{key:s},h)=>{if(h.c||u!==h.a[s])return t&&h.b&&(h.a=i(h.a)),h.a[s]=u,1},1),j({from:"a",target:m}),j({from:"value",store:0,target:c}),j({from:"value",store:1,target:c,priority:"barrier",batch:1}),le(m,1),n&&B()];return Je(r,(u,s)=>{if(!Y(u))return $(!ae(u)&&!z(u),`combine expects a store in a field ${s}`),void(f[s]=l[s]=u);l[s]=u.defaultState,f[s]=u.getState();let h=ue(u,d,o,"combine",n);h.scope.key=s;let p=D(u);Oe(m,{type:"field",field:s,from:p}),q("combineField",p,h)}),d.defaultShape=r,Oe(g,{type:re,from:m,fn:n}),d.defaultState=n?g.current=n(f):l,d};let ur=(e,t,r)=>{try{return[1,e(...r)]}catch(a){return t(a),[0,null]}},fr=e=>{let t=G(e),r={ref:t};return t&&R(t.activeEffects,r),r},lt=(e,t,r,a,n,i)=>l=>{i.ref&&Se(i.ref.activeEffects,i),ge({target:[a,cr],params:[r?{status:"done",params:e,result:l}:{status:"fail",params:e,error:l},{value:l,fn:r?t.rs:t.rj}],defer:1,page:n.page,scope:i.ref,meta:n.meta})};const cr=Z({node:[kt({fn:({fn:e,value:t})=>e(t)})],meta:{op:"fx",fx:"sidechain"}}),dr=["source","clock","target"],At=(e,t)=>e+`: ${t} should be defined`;let mr=(e,t,r,a,n,i,l,f,m,c,d,g)=>{let b=!!n;$(!z(r)||!z(t),At(e,"either source or clock"));let o=0;z(r)?o=1:ae(r)||(r=Pt(r)),z(t)?t=r:(Me(t,e,"clock"),Array.isArray(t)&&(t=Lt(t))),o&&(r=t),f||l||(l=r.shortName);let u="none";(d||a)&&(ae(a)?u="unit":($(C(a),"`filter` should be function or unit"),u="fn")),n?(Me(n,e,"target"),Yt(e,n)):u==="none"&&c&&Y(r)&&Y(t)?n=ye(i?i(pe(D(r)),pe(D(t))):pe(D(r)),{name:l,sid:g,or:f}):(n=O({name:l,derived:1,or:f}),q("sampleTarget",F(n)));let s=ie(),h=[];if(u==="unit"){let[_,k]=it(a,n,t,s,e);h=[...Fe(k),...Fe(_)]}let[p,v]=it(r,n,t,s,e),y=ue(t,n,[q("sampleSourceLoader"),j({from:Q,target:s}),...Fe(v),le(p,1,m),...h,le(s),u==="fn"&&B((_,k,{a:x})=>a(_,x),1),i&&B(De),q("sampleSourceUpward",b)],e,i);return Ee(r,[y]),Object.assign(y.meta,f,{joint:1}),n};const Fe=e=>[le(e),L((t,r,{a})=>a,1)],it=(e,t,r,a,n)=>{let i=Y(e),l=i?D(e):ie(),f=ie(i);return i||Z({parent:e,node:[j({from:Q,target:l}),j({from:"value",store:1,target:f})],family:{owners:[e,t,r],links:t},meta:{op:n},regional:1}),q("sampleSource",f,l,a),[l,f]},Ct=[{label:"Name",systemName:"name",initValue:"",type:"text"},{label:"Link",systemName:"link",initValue:"",type:"text"},{label:"Start date",systemName:"start",initValue:"",type:"date"},{label:"Remind date",systemName:"remind",initValue:"",type:"date"},{label:"Max adults amount",systemName:"max_adults",initValue:"100",type:"number"},{label:"Max children amount",systemName:"max_children",initValue:"100",type:"number"},{label:"Max adults per reservation",systemName:"max_adults_per_reservation",initValue:"4",type:"number"},{label:"Max children per reservation",systemName:"max_children_per_reservation",initValue:"4",type:"number"},{label:"Adult ticket price",systemName:"adult_ticket_price",initValue:"100",type:"number"},{label:"Children ticket price",systemName:"children_ticket_price",initValue:"50",type:"number"},{label:"Currency",systemName:"currency",initValue:"USD",type:"text"}],pr=(e,t)=>t,hr=e=>t=>e(t.target.value),gr=e=>t=>e(t.currentTarget),Le=Ct.map(e=>{const t=O(),r=ye(e.initValue).on(t,pr);return{...e,handler:hr(t),valueStore:r}}),$t=O(),yr=Bt(async e=>{Telegram.WebApp.sendData(JSON.stringify(e))}),br=e=>{const t={};for(let r=0;r<e.length;r++)t[Ct[r].systemName]=e[r];return t};Ht({source:Le.map(({valueStore:e})=>e),clock:$t,fn:br,target:yr});const vr=()=>{};function _r(e){let t,r,a,n,i,l,f;return{c(){t=W("label"),r=W("span"),a=Re(e[0]),n=ve(),i=W("input"),this.h()},l(m){t=H(m,"LABEL",{});var c=J(t);r=H(c,"SPAN",{});var d=J(r);a=je(d,e[0]),d.forEach(I),n=_e(c),i=H(c,"INPUT",{type:!0}),c.forEach(I),this.h()},h(){he(i,"type",e[1]),i.value=e[4]},m(m,c){Ve(m,t,c),E(t,r),E(r,a),E(t,n),E(t,i),l||(f=ut(i,"input",function(){Et(e[2])&&e[2].apply(this,arguments)}),l=!0)},p(m,[c]){e=m,c&1&&It(a,e[0]),c&2&&he(i,"type",e[1]),c&16&&i.value!==e[4]&&(i.value=e[4])},i:K,o:K,d(m){m&&I(t),l=!1,f()}}}function kr(e,t,r){let a,n=K,i=()=>(n(),n=zt(c,d=>r(4,a=d)),c);e.$$.on_destroy.push(()=>n());let{label:l=""}=t,{type:f="text"}=t,{handler:m=vr}=t,{valueStore:c=void 0}=t;return i(),e.$$set=d=>{"label"in d&&r(0,l=d.label),"type"in d&&r(1,f=d.type),"handler"in d&&r(2,m=d.handler),"valueStore"in d&&i(r(3,c=d.valueStore))},[l,f,m,c,a]}class Sr extends We{constructor(t){super(),He(this,t,kr,_r,Ue,{label:0,type:1,handler:2,valueStore:3})}}function xr(e){let t,r;return{c(){t=W("script"),this.h()},l(a){const n=qt("svelte-1nfdud7",document.head);t=H(n,"SCRIPT",{src:!0}),J(t).forEach(I),n.forEach(I),this.h()},h(){Ft(t.src,r="https://telegram.org/js/telegram-web-app.js")||he(t,"src",r)},m(a,n){E(document.head,t)},p:K,i:K,o:K,d(a){I(t)}}}function wr(e,t,r){let{expand:a=!0}=t;return Rt(()=>{a&&Telegram.WebApp.expand()}),e.$$set=n=>{"expand"in n&&r(0,a=n.expand)},[a]}class Nr extends We{constructor(t){super(),He(this,t,wr,xr,Ue,{expand:0})}}function st(e,t,r){const a=e.slice();return a[0]=t[r],a}function ot(e){let t,r;return t=new Sr({props:{label:e[0].label,type:e[0].type,handler:e[0].handler,valueStore:e[0].valueStore}}),{c(){ft(t.$$.fragment)},l(a){ct(t.$$.fragment,a)},m(a,n){dt(t,a,n),r=!0},p:K,i(a){r||(ce(t.$$.fragment,a),r=!0)},o(a){ke(t.$$.fragment,a),r=!1},d(a){mt(t,a)}}}function Mr(e){let t,r,a,n,i,l,f,m,c,d,g,b,o;t=new Nr({});let u=Le,s=[];for(let p=0;p<u.length;p+=1)s[p]=ot(st(e,u,p));const h=p=>ke(s[p],1,1,()=>{s[p]=null});return{c(){ft(t.$$.fragment),r=ve(),a=W("main"),n=W("form"),i=W("h1"),l=Re("Create new event"),f=ve();for(let p=0;p<s.length;p+=1)s[p].c();m=ve(),c=W("button"),d=Re("Create event"),this.h()},l(p){ct(t.$$.fragment,p),r=_e(p),a=H(p,"MAIN",{});var v=J(a);n=H(v,"FORM",{class:!0});var y=J(n);i=H(y,"H1",{});var _=J(i);l=je(_,"Create new event"),_.forEach(I),f=_e(y);for(let x=0;x<s.length;x+=1)s[x].l(y);m=_e(y),c=H(y,"BUTTON",{type:!0});var k=J(c);d=je(k,"Create event"),k.forEach(I),y.forEach(I),v.forEach(I),this.h()},h(){he(c,"type","submit"),he(n,"class","form svelte-14sj0h8")},m(p,v){dt(t,p,v),Ve(p,r,v),Ve(p,a,v),E(a,n),E(n,i),E(i,l),E(n,f);for(let y=0;y<s.length;y+=1)s[y]&&s[y].m(n,null);E(n,m),E(n,c),E(c,d),g=!0,b||(o=ut(n,"submit",gr($t)),b=!0)},p(p,[v]){if(v&0){u=Le;let y;for(y=0;y<u.length;y+=1){const _=st(p,u,y);s[y]?(s[y].p(_,v),ce(s[y],1)):(s[y]=ot(_),s[y].c(),ce(s[y],1),s[y].m(n,m))}for(Dt(),y=u.length;y<s.length;y+=1)h(y);jt()}},i(p){if(!g){ce(t.$$.fragment,p);for(let v=0;v<u.length;v+=1)ce(s[v]);g=!0}},o(p){ke(t.$$.fragment,p),s=s.filter(Boolean);for(let v=0;v<s.length;v+=1)ke(s[v]);g=!1},d(p){mt(t,p),p&&I(r),p&&I(a),Vt(s,p),b=!1,o()}}}class Cr extends We{constructor(t){super(),He(this,t,null,Mr,Ue,{})}}export{Cr as component};
